<%- include('partials/big-header')%>
    <div id="message-bar"></div>
    <%- include('partials/navbar')%>
    <div id="centered-body-container">
      <h1 class="centeredh1"></h1>
      
    <%if(user){%>
      <section class="new-post">
        <form action="/posts" method="POST" autocomplete="off" class="post-form">
          <input type="text" name="title" placeholder="Post Title" id="post-title-input">
          <span id="user-tag">
            Posting as <span id="user-blue"><%=user.username%></span>

          </span>
          
          <br>
          <br>
          <select name="category" id="post-category-input" placeholder="Category">
            <option value="" disabled selected>Select Category</option>
            <%categories.forEach(cat=>{%>
              <option value="<%=cat%>" name="<%=cat%>"><%=cat%></option>  
            <%})%>

          </select>
          <textarea name="content" id="post-content-input" placeholder="......">
          </textarea>
          <button type="submit" id="post-button">Post</button>
        </form>
        </select>       
      </section>
      <%}else{%>
        
    <%}%>
      
      <%posts.forEach(post=>{%>
      <section class="post" data-id="<%=post._id%>">
        <div id="author-profile">
          <div id="author-profile-pic">
            <img src="<%=post.username.toObject().avatar%>" class="user-profile-pic"/>  
          </div>
          <h3>
            
            <%=post.username.toObject().username%>
            
            
          </h3>

                
        </div>
        <p class="post-p">
          <%=post.content%>
        </p>
        <div class="post-content">
          <div class="post-title">
            <h2><%=post.title%></h2>

          </div>
          
          <div class="post-footer">
            <span class="category-tag">
              <%=post.category%>
            </span>
            <%if(user){%>
              <%if(post.username.toObject().googleId===user.googleId){%>
                
                <button class="comment-button" data-id="<%=post._id%>">
                  <%if(post.comments.length>1){%>
                    View <%=post.comments.length%> Comments
                  <%}else if(post.comments.length === 1){%>
                    View <%=post.comments.length%> Comment
                  <%}else{%>
                    Comment
                  <%}%>
                
                </button>
              
              <button class="like-button">Like</button>
              <button type="submit" class="edit-button">Edit</button>  
              <form class="delete-form"action="/posts/<%=post._id%>?_method=DELETE" method="POST">
                <button type="submit" class="delete-button">Delete</button>          
              </form>
              <%}else{%>
                <button class="comment-button comment-button-bottomed" data-id="<%=post._id%>">
                  <%if(post.comments.length>1){%>
                    View <%=post.comments.length%> Comments
                  <%}else if(post.comments.length === 1){%>
                    View <%=post.comments.length%> Comment
                  <%}else{%>
                    Comment
                  <%}%>
                
                </button>
              <button class="like-button like-button-bottomed">Like</button>
  
              <%}%>
            
          </div>
          <%}%>
        </div>

        
        
      </section>
        <section class="post-comment-wrapper" data-id="<%=post._id%>">
          <form action="/posts/<%=post._id%>/comments" class="comment-form" method="POST">
            <textarea name="commentContent" class="comment-content-input"></textarea>
            <button type="submit" class="comment-post-button">Post</button>
          </form>
          <hr>
          <div class="comments-wrapper">
          <%if(user){%>
          
              <%if(post.comments){%>
                <%post.comments.forEach(comment=>{%>
                  <%if(comment.author===user.username){%>
                    <div class="comment-wrapper">
                      <h2 class="comment-author">
                        
                      </h2>
                      <p class="comment-content">
                        
                      </p>
                      <div class="edit-form-container">

                      </div>
                      <span class="comment-footer">

                        <button class="comment-edit-button" data-id="<%=comment.id%>">Edit</button>
                        <form action="/posts/<%=post.id%>/comments/<%=comment.id%>?_method=DELETE" method="POST">
                          <button class="comment-delete-button">Delete</button>
                        </form>
                      </span>
                    </div>
                    
                    <%}else{%>
                      <div class="comment-wrapper">
                        <h2 class="comment-author">
                          
                        </h2>
                        <p class="comment-content">
                          
                        </p>
                        
                      </div>
                      
                      <%}%>  
                      <%})%>
                    <%}%>
              
              
              
                         

            <%}%>
          </div>
      </section>
      <%})%>


    </div>
   
  </body>
</html>
